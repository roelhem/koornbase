
# ------------------------------------------------------------------------------------------------------------------- #
# ----- QUERIES FOR PAGES ------------------------------------------------------------------------------------------- #
# ------------------------------------------------------------------------------------------------------------------- #

# Query for the header
query currentUser {
    currentUser:me {
        ...vueUserMediaCard
    }
}

# Query for the persons.index page
query personsIndex(
        $page:Int = 1,
        $limit:Int = 10,
        $orderBy:Person_orderField = name,
        $orderDir:SortOrderDirection = ASC,
        $filter:Person_filter,
        $search:String
    ) {
    persons(page:$page, limit:$limit, orderBy:[{by:$orderBy, dir:$orderDir}], filter:$filter, search:$search) {
        ...vueSearchTable
        data {
            id
            ...vueDisplayPersonName
            ...vueDisplayPersonBirthDate
            ...vueDisplayMembershipStatus
            avatar {
                ...vueBaseAvatar
            }
        }
    }
}

# Query for the persons.view page
query personsView($id:ID!) {
    person(id:$id) {
        id
        ...vueDisplayPersonName
        ...vueDisplayPersonBirthDate
        ...vueDisplayMembershipStatus
        groups(limit:10) {
            data {
                id
                ...vueKbGroupTag
            }
        }
        addresses {
            data {
                id
                label
                ...vueDisplayPersonAddress
            }
        }
        emailAddresses {
            data {
                id
                label
                email_address
            }
        }
        phoneNumbers {
            data {
                id
                label
                phone_number
            }
        }
        avatar {
            ...vueBaseAvatar
        }
    }
}

# Query for the groups.index page
query groupsIndex (
    $page:Int = 1,
    $limit:Int = 25,
    $orderBy:Group_orderField = name,
    $orderDir:SortOrderDirection = ASC,
    $filter:Group_filter,
    $search:String
    $personLimit:Int = 10
) {
    groups(page:$page, limit:$limit, orderBy:[{by:$orderBy, dir:$orderDir}], filter:$filter, search:$search) {
        ...vueSearchTable
        data {
            id
            category {
                id
                name_short
                style
            }
            persons(limit:$personLimit) {
                total
                data {
                    id
                    name
                    name_short
                    avatar {
                        image
                        letters
                    }
                }
            }
            name
            name_short
            description
            member_name
        }
    }
}

# Query for the groups.view page
query groupsView {
    hello
    groupCategories {
        data {
            id
            ...vueDisplayGroupCategory
        }
    }
}

# Query for the users.index page
query usersIndex {
    hello
}


# Query for the oauth.clients.index page
query oAuthClientIndex(
    $page:Int = 1,
    $limit:Int = 10,
    $orderBy:OAuthClient_orderField = name,
    $orderDir:SortOrderDirection = ASC
    ) {
    clients: oAuthClients(page:$page, limit:$limit, orderBy:[{by:$orderBy, dir:$orderDir}]) {
        ...vueSearchTable
        data {
            id
            name
            created_at
            updated_at
            redirect
            type
            revoked
            user {
                id
                name_display
                person {
                    id
                    name
                }
            }
        }
    }
}


# ------------------------------------------------------------------------------------------------------------------- #
# ----- FRAGMENTS FOR VUE-COMPONENTS -------------------------------------------------------------------------------- #
# ------------------------------------------------------------------------------------------------------------------- #


# __Avatar________________________________________________

fragment vueBaseAvatar on Avatar {
    image
    letters
}

# __Pagination________________________________________________

fragment vueSearchTable on Pagination {
    from
    to
    total
}

# __User__________________________________________________


fragment vueUserDropdown on User {
    id
    avatar {
        ...vueBaseAvatar
    }
    name_display
    person {
        id name_first name_prefix name_last
    }
    email
}

fragment vueUserMediaCard on User {
    ...vueUserDropdown
    name
}


# __Person________________________________________________

# Needed data for a DisplayPersonName component
fragment vueDisplayPersonName on Person {
    name_initials
    name_first
    name_middle
    name_prefix
    name_last
    name_nickname
}

# Needed data from a Person for the DisplayPersonBirthDate component
fragment vueDisplayPersonBirthDate on Person {
    birth_date
    age
}

# Needed data from a Person for the DisplayMembershipStatus component
fragment vueDisplayMembershipStatus on Person {
    membership_status
    membership_status_since
}

# __PersonAddress________________________________________________


# Needed data from a PersonAddress for the DisplayPersonAddress component
fragment vueDisplayPersonAddress on PersonAddress {
    address_line_1
    locality
    country_code
    country
}

# __Group________________________________________________

# Needed data for a KbGroupTag component
fragment vueKbGroupTag on Group {
    name
    name_short
    description
    member_name
    category {
        style
    }
}

# __GroupCategory________________________________________________

# Needed data for a DisplayGroupCategory component
fragment vueDisplayGroupCategory on GroupCategory {
    name
    name_short
    description
    style
}